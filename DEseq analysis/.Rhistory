colnames(countData)
colData <- countData$TP53 levels
colnames(countData)
#colData <- countData$TP53 levels
sort(colnames(countData))
#colData <- countData$TP53 levels
colnames(countData)
#colData <- countData$TP53 levels
colnames(countData)
options(max.print=999999)
#colData <- countData$TP53 levels
options(max.print=999999)
colnames(countData)
#colData <- countData$TP53 levels
#options(max.print=999999)
colnames(countData)
#options(max.print=999999)
#colnames(countData)
colData <- countData$TP53.levels
clear
clearall
clear()
clearall()
#options(max.print=999999)
#colnames(countData)
colData <- countData$TP53.levels
countData <- t(subset(countData, select = -c(TP53.levels) ))
#options(max.print=999999)
#colnames(countData)
colData <- countData$TP53.levels
countData <- t(subset(countData, select = -c(TP53.levels) ))
countData <- read.csv('/Users/shanghongsim/Documents/GitHub/RRM2B-Code-Repository/out.csv', header = TRUE)
head(countData)
colData <- countData$TP53.levels
countData <- t(subset(countData, select = -c(TP53.levels) ))
head(countData)
colData <- countData$TP53.levels
countData <- subset(countData, select = -c(TP53.levels))
head(countData)
countData <- t(countData)
head(countData)
countData <- read.csv('/Users/shanghongsim/Documents/GitHub/RRM2B-Code-Repository/countData.csv', header = TRUE)
colData <- read.csv('/Users/shanghongsim/Documents/GitHub/RRM2B-Code-Repository/colData.csv', header = TRUE)
View(colData)
View(countData)
all(colnames(countData) %in% rownames(colData))
head(countData)
colnames(countData)
rownames(countData) <- countData$X
all(colnames(countData) %in% rownames(colData))
rownames(countData)
View(colData)
rownames(countData) <- countData$X
rownames(countData) <- countData$X
dim(countData)
countData <- subset(countData, select = -c(X) )
dim(countData)
rownames(colData)
rownames(colData) <- colData$X
dim(countData)
colData <- subset(colData, select = -c(X) )
dim(countData)
all(colnames(countData) %in% rownames(colData))
all(colnames(countData) == rownames(colData))
dim(rownames(colData))
len(rownames(colData))
length(rownames(colData))
length(rownames(colData))
length(colnames(countData))
all(colnames(countData) %in% rownames(colData))
colnames(countData) %in% rownames(colData)
rownames(colData)
colnames(countData)
dds <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~ TP53.levels)
# load libraries
library(DESeq2)
library(tidyverse)
library(airway)
# load libraries
library(DESeq2)
library(tidyverse)
dds <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~ TP53.levels)
type(colnames(countData))
type(rownames(colData))
type(rownames(colData)[1])
type(rcolnames(countData)[1])
type(colnames(countData)[1])
head(countData)
head(colData)
rownames(colData) <- colnames(countData)
#colData <- subset(colData, select = -c(X) )
length(rownames(colData))
length(colnames(countData))
all(colnames(countData) %in% rownames(colData))
head(colData)
all(colnames(countData) == rownames(colData))
dds <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~ TP53.levels)
countData <- read.csv('/Users/shanghongsim/Documents/GitHub/RRM2B-Code-Repository/colDataBRCA.csv', header = TRUE)
colData <- read.csv('/Users/shanghongsim/Documents/GitHub/RRM2B-Code-Repository/countDataBRCA.csv', header = TRUE)
rownames(countData) <- countData$X
dim(countData)
countData <- subset(countData, select = -c(X) )
dim(countData)
rownames(colData) <- colnames(countData)
countData <- read.csv('/Users/shanghongsim/Documents/GitHub/RRM2B-Code-Repository/countDataBRCA.csv', header = TRUE)
colData <- read.csv('/Users/shanghongsim/Documents/GitHub/RRM2B-Code-Repository/colDataBRCA.csv', header = TRUE)
rownames(countData) <- countData$X
dim(countData)
countData <- subset(countData, select = -c(X) )
View(countData)
rownames(countData) <- countData$sample
dim(countData)
countData <- subset(countData, select = -c(sample) )
dim(countData)
rownames(colData) <- colnames(countData)
#colData <- subset(colData, select = -c(X) )
length(rownames(colData))
length(colnames(countData))
all(colnames(countData) %in% rownames(colData))
head(countData)
head(colData)
rownames(colData) <- colnames(countData)
colData <- subset(colData, select = -c(X) )
length(rownames(colData))
length(colnames(countData))
all(colnames(countData) %in% rownames(colData))
head(colData)
all(colnames(countData) == rownames(colData))
dds <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~ TP53.levels)
dds <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~ RRM2B_levels)
dds <- DESeqDataSetFromMatrix(countData = round(countData),
colData = colData,
design = ~ RRM2B_levels)
dds
# pre-filtering: removing rows with low gene counts
# keeping rows that have at least 10 reads total
keep <- rowSums(counts(dds)) >= 10
dds <- dds[keep,]
dds
# set the factor level
dds$RRM2B_levels <- relevel(dds$RRM2B_levels, ref = "Top 25%")
# NOTE: collapse technical replicates
# Step 3: Run DESeq ----------------------
dds <- DESeq(dds)
res <- results(dds)
res
# Explore Results ----------------
summary(res)
res0.01 <- results(dds, alpha = 0.01)
summary(res0.01)
# contrasts
resultsNames(dds)
# e.g.: treated_4hrs, treated_8hrs, untreated
results(dds, contrast = c("dexamethasone", "treated_4hrs", "untreated"))
# Explore Results ----------------
summary(res)
res0.01 <- results(dds, alpha = 0.01)
summary(res0.01)
# contrasts
resultsNames(dds)
# e.g.: treated_4hrs, treated_8hrs, untreated
results(dds, contrast = c("dexamethasone", "treated_4hrs", "untreated"))
# MA plot
plotMA(res)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ComplexHeatmap")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ComplexHeatmap")
R. Version()
sessionInfo()
require(devtools)
install_github('andreacirilloac/updateR')
updateR(admin_password = "interlace0280#")
updateR::updateR()
updateR::updateR(admin_password = "interlace0280#")
browseVignettes("updateR")
help("updateR")
updateR()
updateR::updateR()
remove.packages("andreacirilloac/updateR")
install.packages("updateR")
updateR::updateR()
updateR::updateR()
remove.packages("andreacirilloac/updateR")
remove.packages("updateR")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values AOS-genes-screen.csv', header = TRUE)
corrData
help("read.csv")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values AOS-genes-screen.csv', header = TRUE)
corrData
#set specific column as row names
rownames(df) <- df$database
#set specific column as row names
rownames(df) <- df$database
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrData
help("Heatmap")
??Heatmap
Heatmap(corrData)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ComplexHeatmap")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ComplexHeatmap")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ComplexHeatmap",`force = TRUE`)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager",`force = TRUE`)
BiocManager::install("ComplexHeatmap")
BiocManager::install("ComplexHeatmap")
remove.packages("BiocManager")
remove.packages("ComplexHeatmap")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ComplexHeatmap")
install.packages('BiocManager')
install.packages('BiocManager')
library(BiocManager)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ComplexHeatmap")
library("BiocManager")
library("ComplexHeatmap")
library("BiocManager")
library("ComplexHeatmap")
library("grid")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values AOS-genes-screen.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
Heatmap(corrData)
Heatmap(corrData, cluster_rows = FALSE)
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE)
Heatmap(corrMat, cluster_rows = FALSE, clustering_distance_columns = "pearson")
Heatmap(corrMat, cluster_rows = FALSE, column_title = "Antioxidant gene signature (41 genes)",
column_title_side = "bottom")
Heatmap(corrMat, cluster_rows = FALSE, column_km = 3)
View(corrMat)
corrDataImputed <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values AOS-genes-screen-imputed.csv', header = TRUE)
#set specific column as row names
rownames(corrDataImputed) <- corrDataImputed$database
#remove original column from data frame
corrDataImputed$database <- NULL
corrMatImputed <- data.matrix(corrDataImputed)
Heatmap(corrMatImputed, cluster_rows = FALSE, column_km = 3)
Heatmap(corrMatImputed, cluster_rows = FALSE, column_km = 2)
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE)
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE)
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE)
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation coefficient",
column_title = "Correlation of antioxidant transcription factor activity with RRM2B expression",
column_title_side = "bottom")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation coefficient",
column_title = "Correlation of antioxidant transcription factor activity with RRM2B expression",
column_title_side = "bottom",
column_title_gp = gpar(fontsize = 12))
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation coefficient",
column_title = "Correlation of antioxidant transcription factor activity \n with RRM2B expression",
column_title_side = "bottom"))
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation coefficient",
column_title = "Correlation of antioxidant transcription factor activity \n with RRM2B expression",
column_title_side = "bottom")
library(circlize)
col_fun = colorRamp2(c(-0.5, 0, 0.5), c("blue", "white", "red"))
col_fun(seq(-3, 3))
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation coefficient",
column_title = "Correlation of antioxidant transcription factor activity \n with RRM2B expression",
column_title_side = "bottom",
col = col_fun)
library(circlize)
col_fun = colorRamp2(c(-0.5, 0, 0.5), c("red", "white", "blue"))
col_fun(seq(-3, 3))
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation coefficient",
column_title = "Correlation of antioxidant transcription factor activity \n with RRM2B expression",
column_title_side = "bottom",
col = col_fun)
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
ht1 = Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation coefficient",
column_title = "Correlation of antioxidant transcription factor activity \n with RRM2B expression",
column_title_side = "bottom",
col = col_fun)
o1 = row_order(ht1)
o1 = row_order(ht1)
o1
o1 = col_order(ht1)
o1 = column_order(ht1)
o1
browseVignettes("ComplexHeatmap")
browseVignettes("ComplexHeatmap")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values NRF2 screen-imputed.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, column_title = "Antioxidant gene signature (41 genes)",
column_title_side = "bottom")
library("BiocManager")
library("ComplexHeatmap")
library("grid")
Heatmap(corrMat, cluster_rows = FALSE, column_title = "Antioxidant gene signature (41 genes)",
column_title_side = "bottom")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values NRF2 screen-imputed.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, column_title = "Antioxidant gene signature (41 genes)",
column_title_side = "bottom")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values NRF2 screen-imputed.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, column_title = "Antioxidant gene signature (41 genes)",
column_title_side = "bottom")
View(corrData)
library("BiocManager")
library("ComplexHeatmap")
library("grid")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/results/nrf2 heatmap/r values NRF2 screen-imputed.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, column_title = "Antioxidant gene signature (41 genes)",
column_title_side = "bottom")
Heatmap(corrMat, cluster_rows = FALSE, column_title = "NRF2 signature (24 genes)",
column_title_side = "bottom")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/results/nrf2 heatmap/r values NRF2 screen-imputed.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, column_title = "NRF2 signature (24 genes)",
column_title_side = "bottom")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/results/nrf2 heatmap/r values NRF2 screen-imputed.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, column_title = "NRF2 signature (24 genes)",
column_title_side = "bottom", name = "Pearson correlation coefficient")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/results/nrf2 heatmap/r values NRF2 screen-imputed.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, column_title = "NRF2 signature (24 genes)",
column_title_side = "bottom", name = "r value")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen with bach.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
ht1 = Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation coefficient",
column_title = "Correlation of antioxidant transcription factor activity \n with RRM2B expression (with BACH genes)",
column_title_side = "bottom",
col = col_fun)
library("BiocManager")
library("ComplexHeatmap")
library("grid")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen with bach.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
ht1 = Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation coefficient",
column_title = "Correlation of antioxidant transcription factor activity \n with RRM2B expression (with BACH genes)",
column_title_side = "bottom",
col = col_fun)
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen with bach.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
ht1 = Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation coefficient",
column_title = "Correlation of antioxidant transcription factor activity \n with RRM2B expression (with BACH genes)",
column_title_side = "bottom")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen with bach.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation coefficient",
column_title = "Correlation of antioxidant transcription factor activity \n with RRM2B expression (with BACH genes)",
column_title_side = "bottom")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen with bach.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation coefficient",
column_title = "Correlation of antioxidant transcription factor activity \n with RRM2B expression (with BACH genes)",
column_title_side = "bottom")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen with bach.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation \n coefficient",
column_title = "Correlation of antioxidant transcription factor activity \n with RRM2B expression (with BACH genes)",
column_title_side = "bottom")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/r values signature screen.csv', header = TRUE)
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/results/antioxidant network screen/r values signature screen.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
ht1 = Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation \n coefficient",
column_title = "Correlation of antioxidant transcription factor activity \n with RRM2B expression",
column_title_side = "bottom")
corrData <- read.csv('/Users/shanghongsim/Documents/GitHub/HU-ATRi-Code-Repository/results/antioxidant network screen/r values signature screen.csv', header = TRUE)
#set specific column as row names
rownames(corrData) <- corrData$database
#remove original column from data frame
corrData$database <- NULL
corrMat <- data.matrix(corrData)
Heatmap(corrMat, cluster_rows = FALSE, name = "Pearson correlation \n coefficient",
column_title = "Correlation of antioxidant transcription factor activity \n with RRM2B expression",
column_title_side = "bottom")
